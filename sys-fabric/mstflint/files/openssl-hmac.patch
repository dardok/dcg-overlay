diff -u -r -N a/mlxsign_lib/mlxsign_lib.cpp b/mlxsign_lib/mlxsign_lib.cpp
--- a/mlxsign_lib/mlxsign_lib.cpp	2018-08-28 09:47:49.000000000 -0400
+++ b/mlxsign_lib/mlxsign_lib.cpp	2019-11-03 04:06:37.313617525 -0500
@@ -360,8 +360,7 @@
 
 MlxSignHMAC::MlxSignHMAC()
 {
-    ctx = malloc(sizeof(HMAC_CTX));
-    HMAC_CTX_init((HMAC_CTX*)ctx);
+    ctx = HMAC_CTX_New();
 }
 
 int MlxSignHMAC::setKey(const std::vector<u_int8_t>& key)
@@ -415,8 +414,7 @@
 
 MlxSignHMAC::~MlxSignHMAC()
 {
-    HMAC_CTX_cleanup((HMAC_CTX*)ctx);
-    free(ctx);
+    HMAC_CTX_free(ctx);
 }
 
 #endif //ENABLE_OPENSSL
diff -u -r -N a/mlxsign_lib/mlxsign_lib.h b/mlxsign_lib/mlxsign_lib.h
--- a/mlxsign_lib/mlxsign_lib.h	2018-08-28 09:47:49.000000000 -0400
+++ b/mlxsign_lib/mlxsign_lib.h	2019-11-03 04:05:49.638346871 -0500
@@ -165,7 +165,7 @@
     ~MlxSignHMAC();
 
 private:
-    void *ctx;
+    HMAC_CTX *ctx;
     std::vector<u_int8_t> data;
 
 };
